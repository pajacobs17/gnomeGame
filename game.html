<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Welcome</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link href="style.css" rel="stylesheet" type="text/css" />
	
	<!--SCRIPTS -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="simpleGame.js"></script>
</head>

<body onload="init()" style="background-color: #009900;">

	<script>
		//Game vars
        var game = new Scene();
        var all = document.getElementsByTagName("canvas");
        var canvas = all[0];
		var board = new Array();
		
		
        //Sprites
        var gnomeList = [];
        var brandy

        function gnome(src){
          //generate random numbers to position gnome
          var posH = randNum(canvas.clientHeight);
          var posW = randNum(canvas.clientWidth);

          //create gnome
          //86 and 135 are the width and height of the gnome picture
          var aGnome = new Sprite(game, src, 86, 135);
          aGnome.setSpeed(0);
          aGnome.setPosition(posW, posH);

          return aGnome;
        }

         /* function should return one number that are within bounds of the canvas */
        function randNum(num){
          //setting max and min to make sure gnomes won't go beyond/touch border
          var max = (num - 100);
          var min = 200;
          var rand = Math.floor(Math.random() * (max - min)) + min;
          return rand;
        }

        function mower(){
        var mower = new Sprite(game, "img/Brandy-Forward.png", 100, 225);
        mower.setSpeed(0);
        mower.setPosition(50, 115);

        mower.checkKeys = function(){
            //temporary function for testing
            if (keysDown[K_UP]){
                this.changeYby(-5);
                 this.setImage("img/Brandy-Back.png")
            }
            
            if (keysDown[K_DOWN]){
                this.changeYby(5);
                 this.setImage("img/Brandy-Forward.png")
            }
            
            if (keysDown[K_LEFT]){
               this.setImage("img/Brandy-Left.png")
                this.changeXby(-5);
            }
            
            if (keysDown[K_RIGHT]){
                this.setImage("img/Brandy-Right.png")
                this.changeXby(5);
            }
        } // end checkKeys


        return mower;
        }

        function init(){
			 canvas.setAttribute("id", "gameCanvas");
		 
            brandy = new mower();

            gnomeList.push(new gnome("img/blueGnome.png"));
            gnomeList.push(new gnome("img/purpleGnome.png"));
			
			createInitialBoard();
			
            //game.start();
        }
        
        function update(){
            game.clear();
			
			
            //for each frame:
              //set speed to 5, 
              //give the gnome a new random direction, 
              //redraw the gnome, and 
              //check for collision
            for(i = 0; i < gnomeList.length; i++) {
              gnomeList[i].setSpeed(5);
              newDir = (Math.random() * 90 -45);
              gnomeList[i].changeMoveAngleBy(newDir);
              gnomeList[i].update();
              checkCollisions(gnomeList[i]);
            }
            //check the keypress for player and redraw player
            brandy.checkKeys();
            brandy.update();
			
        }

        /*
          check whether or not the player has colllided with a gnome
          if the player has collided with a gnome, end the game with an alert and beyond
          refreshing the page
        */
        function checkCollisions(gnome){
          //if a collision has occured, end the game
            if (brandy.collidesWith(gnome)){
                alert("You have failed in the ultimte quest to mow your lawn. Good luck next time.")
                game.stop();
                document.location.href = "";
            }
        }

		function createBoard() {
			for(var i = 0; i < canvas.clientHeight; i += 100) {
				var array = new Array();
				board.push(array);
				
				for(var j = 0; j < canvas.clientWidth; j += 100) {
					board[0][0] = true;
				}
			}
		}
		
		function createInitialBoard() {
			var count = 0;
			for(var i = 50; i <= canvas.clientHeight; i += 100) {
				for(var j = 50; j <= canvas.clientWidth; j += 100) {
					board.push(new Sprite(game, "img/grass.jpg", 100, 100));
					board[count].setPosition(i, j);
					board[count].update();
					count++;
				}
			}
		}
	</script>
</body>

</html>
